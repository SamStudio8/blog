<!DOCTYPE html>
<html lang="en-GB">

<head>
	<meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="pingback" href="https://samnicholls.net/xmlrpc.php">

	
	<title>Status Report: November 2016 (Part II): Revisiting the Synthetic Metahaplomes &#8211; Samposium</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Samposium &raquo; Feed" href="https://samnicholls.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="Samposium &raquo; Comments Feed" href="https://samnicholls.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Samposium &raquo; Status Report: November 2016 (Part II): Revisiting the Synthetic Metahaplomes Comments Feed" href="https://samnicholls.net/2016/12/24/status-nov16-p2/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/samnicholls.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.5"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='https://samnicholls.net/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-github-css'  href='https://samnicholls.net/wp-content/plugins/crayon-syntax-highlighter/themes/github/github.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://samnicholls.net/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://samnicholls.net/wp-includes/css/dist/block-library/style.min.css?ver=5.7.5' type='text/css' media='all' />
<link rel='stylesheet' id='css-style-css'  href='https://samnicholls.net/wp-content/themes/responsive-deluxe/css/style.css?ver=5.7.5' type='text/css' media='all' />
<link rel='stylesheet' id='child-style-css'  href='https://samnicholls.net/wp-content/themes/responsive-deluxe-child/style.css?ver=5.7.5' type='text/css' media='all' />
<link rel='stylesheet' id='lato-css'  href='//fonts.googleapis.com/css?family=Lato%3A400%2C700%2C400italic&#038;ver=5.7.5' type='text/css' media='all' />
<link rel='stylesheet' id='slabo-css'  href='//fonts.googleapis.com/css?family=Slabo+27px&#038;ver=5.7.5' type='text/css' media='all' />
<link rel='stylesheet' id='fa-css'  href='https://samnicholls.net/wp-content/themes/responsive-deluxe/css/font-awesome.css?ver=5.7.5' type='text/css' media='all' />
<link rel='stylesheet' id='rd-style-css'  href='https://samnicholls.net/wp-content/themes/responsive-deluxe-child/style.css?ver=5.7.5' type='text/css' media='all' />
<link rel='stylesheet' id='css-custom-css'  href='https://samnicholls.net/wp-content/themes/responsive-deluxe/css/custom.css?ver=5.7.5' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://samnicholls.net/wp-content/plugins/jetpack/css/jetpack.css?ver=4.9' type='text/css' media='all' />
<script type='text/javascript' src='https://samnicholls.net/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://samnicholls.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' id='crayon_js-js-extra'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/samnicholls.net\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://samnicholls.net/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta' id='crayon_js-js'></script>
<script type='text/javascript' src='https://samnicholls.net/wp-content/plugins/fd-footnotes/fdfootnotes.js?ver=1.34' id='fdfootnote_script-js'></script>
<script type='text/javascript' src='https://samnicholls.net/wp-content/themes/responsive-deluxe/js/bootstrap.js?ver=5.7.5' id='bootstrap-js'></script>
<script type='text/javascript' src='https://samnicholls.net/wp-content/themes/responsive-deluxe/js/custom.js?ver=5.7.5' id='js-custom-js'></script>
<link rel="https://api.w.org/" href="https://samnicholls.net/wp-json/" /><link rel="alternate" type="application/json" href="https://samnicholls.net/wp-json/wp/v2/posts/1916" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://samnicholls.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://samnicholls.net/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.5" />
<link rel="canonical" href="https://samnicholls.net/2016/12/24/status-nov16-p2/" />
<link rel='shortlink' href='https://wp.me/p6RfP0-uU' />
<link rel="alternate" type="application/json+oembed" href="https://samnicholls.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsamnicholls.net%2F2016%2F12%2F24%2Fstatus-nov16-p2%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://samnicholls.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsamnicholls.net%2F2016%2F12%2F24%2Fstatus-nov16-p2%2F&#038;format=xml" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62206786-1', 'auto');
  ga('send', 'pageview');

</script>


<link rel='dns-prefetch' href='//v0.wordpress.com'>
<style type='text/css'>img#wpstats{display:none}</style>
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Status Report: November 2016 (Part II): Revisiting the Synthetic Metahaplomes" />
<meta property="og:url" content="https://samnicholls.net/2016/12/24/status-nov16-p2/" />
<meta property="og:description" content="The second installment of this year&#8217;s Christmas Special. We revisit our old friend, the DHFR dataset and discover that not everything is as awful as it seems." />
<meta property="article:published_time" content="2016-12-24T01:19:57+00:00" />
<meta property="article:modified_time" content="2016-12-24T01:33:47+00:00" />
<meta property="og:site_name" content="Samposium" />
<meta property="og:image" content="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-05-30-25-1024x576.png" />
<meta property="og:locale" content="en_GB" />
<meta name="twitter:card" content="summary" />
</head>

<body class="post-template-default single single-post postid-1916 single-format-standard">


        
<header id="main-header">
    <nav class="navbar-default navbar-static-top navbar" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#rd-collapse">
                    <span class="fa fa-bars"></span>
                    <span class="sr-only screen-reader-text">Toggle navigation</span>
                </button>
                <a class="navbar-brand" href=" https://samnicholls.net/">Samposium</a>            </div>
            
            <div id="rd-collapse" class="collapse navbar-collapse">
            
            <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body class="post-template-default single single-post postid-1916 single-format-standard">

<div id="main-menu" class="navbar-nav nav"><ul>
<li class="page_item page-item-8"><a href="https://samnicholls.net/about/">About Me</a></li>
<li class="page_item page-item-11"><a href="https://samnicholls.net/talks/">Talks</a></li>
<li class="page_item page-item-15"><a href="https://samnicholls.net/things-i-have-learned/">Things I Have Learned</a></li>
</ul></div></body></html>
        </div>

        </div>
    </nav>
</header>

<div class="container">

    <div class="row"><!-- Content -->
<section class="col-md-8 content-container">
                          <article class="card post hentry post-1916 type-post status-publish format-standard category-au-phd category-status-report" id="post-1916">
                <header class="entry-header">
                        <h1 class="entry-title">Status Report: November 2016 (Part II): Revisiting the Synthetic Metahaplomes</h1>                </header><!-- .entry-header -->

                <div class="meta-well">
                    <span style="margin-right:15px;" class=""><span class="fa fa-user"></span>&nbsp;&nbsp;&nbsp;<span class="author vcard"><a class="url fn n" href="https://samnicholls.net/about/">Sam Nicholls</a></span></span>

                    <span style="margin-right:15px;" class="entry-date published updated post-date"><span class="fa fa-clock-o"></span>&nbsp;&nbsp; <time class="entry-date published" datetime="2016-12-24T01:19:57+00:00">24th December 2016</time><time class="updated" datetime="2016-12-24T01:33:47+00:00">24th December 2016</time></span>                    <span style="margin-right:15px;" class=""><span class="fa fa-comments-o"></span>&nbsp;&nbsp; <a href="https://samnicholls.net/2016/12/24/status-nov16-p2/#respond"><span class="dsq-postid" data-dsqidentifier="1916 https://samnicholls.net/?p=1916">No Comments yet</span></a></span>
                    <span class=""><span class="fa fa-folder-open"></span>&nbsp;&nbsp;&nbsp;<a href="https://samnicholls.net/category/bioinf/au-phd/" rel="category tag">AU-PhD</a>, <a href="https://samnicholls.net/category/status-report/" rel="category tag">Status Report</a></span>
                </div>

                <div class="entry-content"><p><a href="https://samnicholls.net/2016/12/19/status-nov16-p1/">In the opening act of this status report</a>, I described the abrupt and unfortunate end to the adventure of <a href="http://biorxiv.org/content/early/2016/08/02/067215">my pre-print</a>. In response to reviewer feedback, I outlined three major tasks that lie ahead in wait for me, blocking the path to an enjoyable Christmas holiday, and a better manuscript submission to <strike>a more specialised</strike> an alternative journal:</p>
<ul>
<span style="color: #999999;"></p>
<li><b>Improve Triviomes</b></span><br />
<span style="color: #999999;">We are already doing something interesting and novel, but the &#8220;triviomes&#8221; are evidently convoluting the explanation. We need something with more biological grounding such that we don&#8217;t need to spend many paragraphs explaining why we&#8217;ve made certain simplifications, or cause readers to question why we are doing things in a particular way. Note this new method will still need to give us a controlled environment to test the limitations of <code>Hansel</code> and <code>Gretel</code>.</span></li>
</ul>
<ul>
<li><strong>Polish DHFR and AIMP1 analysis</strong><br />
One of our reviewers misinterpreted some of the results, and drew a negative conclusion about <code>Gretel</code>&#8216;s overall accuracy. I&#8217;d like to revisit the <em>DHFR</em> and <em>AIMP1</em> data sets to both improve the story we tell, but also to describe in more detail (with more experiments) under what conditions we can and cannot recover haplotypes accurately.</li>
</ul>
<ul>
<span style="color: #999999;"></p>
<li><b>Real Reads</b></span><br />
<span style="color: #999999;">Create and analyse a data set consisting of real reads.</span></li>
</ul>
<p>The <a href="https://samnicholls.net/2016/12/19/status-nov16-p1/">first part of this report</a> covers my vented frustrations with both generating, but particularly analysing the new &#8220;Treeviomes&#8221; in depth. This part will now turn focus to the sequel of my already existing <code>DHFR</code> analysis, addressing the reasoning behind a particularly crap set of recoveries and reassuring myself that perhaps everything is not a disaster after all.</p>
<div class="success">Friends and family, you might be happy to know that I am <a href="https://samnicholls.net/2016/12/19/status-nov16-p1/">less grumpy than last week</a>, as a result of the work described in this post. You can <a href="#tldr">skip to the tldr</a> now.</div>
<hr />
<h2>DHFR II: Electric Boogaloo</h2>
<h3>Flashback</h3>
<p>Our preprint builds upon the initial naive testing of <code>Hansel</code> and <code>Gretel</code> on recovery of randomly generated haplotypes, by introducing a pair of metahaplomes that each contain five haplotypes of varying similarity of a particular gene; namely <a href="http://www.uniprot.org/uniprot/P00374"><code>DHFR</code></a> and <a href="http://www.uniprot.org/uniprot/Q12904"><code>AIMP1</code></a>.</p>
<p><a href="https://samnicholls.net/wp-content/uploads/2016/12/more-05-e1482266355408.png"><img src="https://samnicholls.net/wp-content/uploads/2016/12/more-05-e1482266281530-1024x312.png" alt="" width="80%" class="alignnone size-large wp-image-1940" /></a></p>
<p>Testing follows the same formula <a href="https://samnicholls.net/2016/10/24/status-sep16/">as we&#8217;ve discussed in a previous blog post</a>:</p>
<ul>
<li>Select a <strong>master</strong> gene (an arbitrary, <code>DHFR</code>, in this case)</li>
<li><code>megaBLAST</code> for similar sequences and select <code>5</code> arbitrary sequences of <strong>decreasing identity</strong></li>
<li>Extract the overlapping regions on those sequences, these are the <strong>input haplotypes</strong></li>
<li>Generate a random set of (now properly) uniformly distributed reads, of a fixed length and coverage, from each of the input haplotypes</li>
<li>Use the master as a <strong>pseudo-reference</strong> against which to align your synthetic reads</li>
<li>Stand idly by as many of your reads are hopelessly discarded by your favourite aligner</li>
<li>Call for variants on what is left of your aligned reads by assuming any heterogeneous site is a variant</li>
<li>Feed the aligned reads and called variant positions to <code>Gretel</code></li>
<li>Compare the recovered haplotypes, to the input haplotypes, with <code>BLAST</code></li>
</ul>
<p><a href="https://samnicholls.net/wp-content/uploads/2016/12/more-06-e1482266337911.png"><img src="https://samnicholls.net/wp-content/uploads/2016/12/more-06-e1482266315235-1024x491.png" alt="" width="80%" class="alignnone size-large wp-image-1941" /></a></p>
<p>As <a href="http://biorxiv.org/content/early/2016/08/02/067215">described in our paper</a>, results for both the <code>DHFR</code> and <code>AIMP1</code> data sets were promising, with up to 99% of SNPs correctly recovered to successfully reconstruct the input haplotypes. We have shown that haplotypes can be recovered from short reads that originate from a metagenomic data set. However, I want to revisit this analysis to improve the story and fix a few outstanding issues:</p>
<ul>
<li>A reviewer assumed lower recovery rates on haplotypes with poorer identity to the pseudo-reference was purely down to bad decision making by <code>Gretel</code>, and not to do with the long paragraph about how this is caused by discarded reads</li>
<li>A reviewer described the tabular results as hard to follow</li>
<li>I felt I had not provided a deep enough analysis to readers into the effects of read length and coverage, although no reviewer asked for this, it will help me sleep at night</li>
<li>Along the same theme, the tables in the pre-print only provided averages, whereas I felt a diagram might better explain some of the variance observed in recovery rates</li>
<li>Additionally, I&#8217;d updated the read generator as part of my work on the &#8220;Treeviomes&#8221; discussed in my last post, particularly to generate more realistic looking distributions of reads, I <em>needed</em> to check results were still reliable and thought it would be helpful if we had a consistent story between our data sets</li>
</ul>
<h3>Progress</h3>
<p>Continuing the rampant pessimism that can be found in the first half of this status report, I wanted to audit my work on these &#8220;synthetic metahaplomes&#8221;, particularly given the changed results between the Triviomes, and more biologically realistic and tangible Treeviomes. I wanted to be sure that we had not departed from the good results introduced in the <code>DHFR</code> and <code>AIMP1</code> sections of the paper.</p>
<p>To be a little less gloomy, I was also inspired by the progress I had made on the analysis of the Treeviomes. I felt we could we could try and uniformly present our results and use box diagrams similar to those that I had finally managed to design and plot at the end of my last post. I feel these diagrams provide a much more detailed insight to the capabilities of <code>Gretel</code> given attributes of read sets such as length and coverage. Additionally, we know each of the input haplotypes, which unlike the uniformly varying sequences of our Treeviomes, have decreasing similarity to the pseudo-reference; thus we can use such a plot to describe <code>Gretel</code>&#8216;s accuracy with respect to each haplotype&#8217;s distance from the pseudo-reference (somewhat akin to how we present results for different values of per-haplotype per-base sequence mutation rates on our Treeviomes).</p>
<p>So here&#8217;s one I made earlier:</p>
<p><a href="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-18-24-42.png"><img src="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-18-24-42-1024x576.png" alt="" width="100%" class="alignnone size-large wp-image-1984" srcset="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-18-24-42-1024x576.png 1024w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-18-24-42-300x169.png 300w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-18-24-42-768x432.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>Sam, what the fuck am I looking at?</p>
<ul>
<li>Vertical facets are read length</li>
<li>Horizontal facets represent each of the five input haplotypes, ordered by decreasing similarity to the chosen <code>DHFR</code> pseudo-reference</li>
<li>X-axis of each boxplot is the average read coverage for each of the ten generated read sets</li>
<li>Y-axis is the average best recovery rate for a given haplotype, over the ten runs of <code>Gretel</code>: each boxplot summarising the best recoveries for ten randomly generated uniform distributed sets of reads (with a set read length and coverage)</li>
<li>Top scatter plot shows number of called variants across the ten sets of reads for each length-coverage parameter pair</li>
<li>Bottom scatter plot shows for each of the ten read sets, the proportion of reads from each haplotype that were dropped during alignment</li>
</ul>
<p>What can we see?</p>
<ul>
<li><strong>Everything is not awful</strong>: three of the five haplotypes can be recovered to around 95% accuracy, even with very short reads (75-100bp), and reasonable average per-haplotype coverage.</li>
<li>Good recovery of <code>AK232978</code>, despite a 10% mutation rate when compared to the pseudo-reference: <code>Gretel</code> yielded haplotypes with 80% accuracy. </li>
<li>Recovery of <code>XM_012113510</code> is particularly difficult. Even given long reads (150-250bp) and high coverage (50x) we fail to reach 75% accuracy. Our pre-print hypothesiszed that this was due to its 82.9% identity to the pseudo-reference causing dropped reads.</li>
</ul>
<p>Our pre-print presents results considering just one read set for each of the length and coverage parameter pairs. Despite the need to perhaps take those results with a pinch of salt, it is somewhat relieving to see that our new more robust experiment yields very similar recovery rates across each of the haplotypes. With the exception of <code>XM_012113510</code>.</p>
<h3>The Fall of &#8220;XM&#8221;</h3>
<p>Recovery rates for our synthetic metahaplomes, such as <code>DHFR</code>, are found by <code>BLAST</code>ing the haplotypes returned by <code>Gretel</code> against the five known, input haplotypes. The &#8220;best haplotype&#8221; for an input is defined as the output haplotype with the fewest mismatches against the given input. We report the recovery rate by assuming the mismatches are the incorrectly recovered variants, and divide this by the number of variants called over the read set that yielded this haplotype.</p>
<p>We cannot simply use sequence identity as a score: consider a sequence of 100bp, if there are just 5 variants, all of which are incorrectly reconstructed, <code>Gretel</code> will still appear to be 95% accurate, rather than correctly reporting 0% (1 &#8211; 5/5). Note however, that our method does somewhat assume that variants are called perfectly: remember that homogenous sites are ignored by <code>Gretel</code>, so any &#8220;missed&#8221; SNPs, will always mismatch the input haplotypes, as we &#8220;fill in&#8221; homogeneous sites when outputting the output haplotype FASTA, with the nucleotides from the pseudo-reference.</p>
<p><code>XM_012113510</code> posed an interesting problem for evaluation. When collating results for the pre-print, I found the corresponding best haplotype failed to align the entirity of the gene (564bp) and instead yielded two high scoring, non-overlapping hits. When I updated the harness that calculates and collates recovery rates across all the different runs of <code>Gretel</code>, I overlooked the possibility for this and forced selection of the &#8220;best&#8221; hit (<code>-max_hsps 1</code>). Apparently, this split-hit behaviour was not a one-off, but almost universal across all runs of <code>Gretel</code> over the 640 sets of reads.</p>
<p>In fact, the split-hit was highly precise. Almost every best <code>XM_012113510</code> haplotype had a hit along the first 87bp, and another starting at (or very close to) 135bp, stretching across the remainder of the gene. My curiosity piqued, I fell down another rabbit hole.</p>
<h3>Curious Coverage</h3>
<p>I immediately assumed this must be an interesting side-effect of read dropping. I indicated in our pre-print that we had difficulty aligning reads against a pseudo-reference where those reads originate from a sequence that is dissimilar (&lt;= 90% identity) from the reference. This read dropping phenomenon has been one of the many issues our lab has experiened with current bioinformatics tooling when dealing with metagenomic data sets.</p>
<p>Indeed, our boxplot above features a colour-coded scatter plot that demonstrates that the two most dissimilar input haplotypes <code>AK</code> and <code>XM</code>, are also the haplotypes that experience the most trouble during read alignment. I suggested in the pre-print that thes dropped reads are the underlying reason for <code>Gretel</code>&#8216;s performance on those more dissimilar haplotypes.</p>
<p>I wanted to see empirically whether this was the case, and to potentially find a nice way of providing evidence, given that one of our reviewers missed my attribution of these poorer <code>AK</code> and <code>XM</code> recoveries to trouble with our alignment step, rather than incompetence on <code>Gretel</code>&#8216;s part. I knocked up a small Python script that deciphered my automatically generated read names, and calculated <strong>per-haplotype read coverage</strong>, for each of the five input haplotypes, across the 640 alignments.</p>
<p><a href="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-21-01-41-32.png"><img src="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-21-01-41-32-1024x206.png" alt="" width="100%" class="alignnone size-large wp-image-1966" srcset="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-21-01-41-32-1024x206.png 1024w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-21-01-41-32-300x60.png 300w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-21-01-41-32-768x155.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<ul>
<li>X-axis represents genomic position along the psuedo-reference (the &#8220;master&#8221; `DHFR gene)</li>
<li>Y-axis labels each of the input haplotype, starting with the most dissimilar (<code>XM</code>) and ending on the most similar (<code>BC</code>)</li>
<li>The coloured heatmap plots the average coverage for a given haplotype at a given position, across all generated BAM files</li>
</ul>
<p>Well look what we have here&#8230; Patches of <code>XM</code> and <code>AK</code> are most definitely <strong>poorly supported by reads</strong>! This is troubling for their recovery, as <code>Hansel</code> stores pairwise evidence of variants co-occurring on the same read. If those reads are discarded, we have no evidence of that haplotype. It should be no surprise that <code>Gretel</code> has difficultly here. We can&#8217;t create evidence from nothing.</p>
<p>What&#8217;s this?&#8230; A crisp, ungradiated, dark navy box representing absolutely 0 reads across any of the 640 alignments, sitting on our <code>XM</code> gene. If I had to guesstimate the bounds of that box on the X-axis, I would bet my stipend that they&#8217;ll be a stonesthrow from 87 and 135bp&#8230; The bounds of the split <code>BLAST</code> hits we were reliably generating against <code>XM_012113510</code>, almost 640 times. I delved deeper. What did the <code>XM</code> reads over that region look like? Why didn&#8217;t they align correctly? Where they misaligned, or dropped entirely?</p>
<p>But I couldn&#8217;t find any.</p>
<h3>Having a blast with BLAST</h3>
<p>After much head scratching. I began an audit from the beginning, consulting the <code>BLAST</code> record that led me to select <code>XM_012113510.1</code> for our study:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64f105b05e9a5578588547" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
EU145592.1   XM_012113510.1   82.979   564   46   1   1   564   52   565   3.89e-175   625</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-64f105b05e9a5578588547-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64f105b05e9a5578588547-1"><span class="crayon-v">EU145592</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">XM_012113510</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">82.979</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">564</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">46</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">564</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">52</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">565</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">3.89e</span><span class="crayon-o">-</span><span class="crayon-cn">175</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">625</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>Seems legit? An approximately 83% hit with full query coverage (564bp) consisting of 46 mismatches and containing an indel of length one? Not quite, as I would later find. But to cut an already long story somewhat shorter. The problem boils down to me being unable to read, again.</p>
<ul>
<li><code>BLAST</code> <em>outfmt6</em> alignment lengths include deletions on the subject</li>
<li><code>BLAST</code> <em>outfmt6</em> tells you the number of gaps, not their size</li>
</ul>
<p>For fuck&#8217;s sake, Sam. Sure enough, here&#8217;s the full alignment record. Complete with a fucking gigantic 50bp deletion on the subject, <code>XM_012113510</code>.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64f105b05e9af972063134" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Query  1    ATGGTTGGTTCGCTAAACTGCATCGTCGCTGTGTCCCAGAACATGGGCATCGGCAAGAAC  60
            |||||| || ||||||||||||||||||||||||||||||||||||||||||||||||||
Sbjct  52   ATGGTTCGTCCGCTAAACTGCATCGTCGCTGTGTCCCAGAACATGGGCATCGGCAAGAAC  111

Query  61   GGGGACCTGCCCTGGCCACCGCTCAGGAATGAATTCAGATATTTCCAGAGAATGACCACA  120
            ||| |||||||||||||||| |||||                                  
Sbjct  112  GGGAACCTGCCCTGGCCACCACTCAG----------------------------------  137

Query  121  ACCTCTTCAGTAGAAGGTAAACAGAATCTGGTGATTATGGGTAAGAAGACCTGGTTCTCC  180
                            ||||||||||| ||||||||||||||| ||||||||||||||||
Sbjct  138  ----------------GTAAACAGAATTTGGTGATTATGGGTAGGAAGACCTGGTTCTCC  181

Query  181  ATTCCTGAGAAGAATCGACCTTTAAAGGGTAGAATTAATTTAGTTCTCAGCAGAGAACTC  240
            ||||| ||||||||||||||||||||||  ||||||||| |||||||||| |||||||||
Sbjct  182  ATTCCAGAGAAGAATCGACCTTTAAAGGACAGAATTAATATAGTTCTCAGTAGAGAACTC  241

Query  241  AAGGAACCTCCACAAGGAGCTCATTTTCTTTCCAGAAGTCTAGATGATGCCTTAAAACTT  300
            |||||||||||| | ||||||||||||||| ||| |||||| |||||||||||| |||||
Sbjct  242  AAGGAACCTCCAAAGGGAGCTCATTTTCTTGCCAAAAGTCTGGATGATGCCTTAGAACTT  301

Query  301  ACTGAACAACCAGAATTAGCAAATAAAGTAGACATGGTCTGGATAGTTGGTGGCAGTTCT  360
            | |||| | ||||||||| ||||||||||||||||||| |||||||| || |||||||||
Sbjct  302  ATTGAAGATCCAGAATTAACAAATAAAGTAGACATGGTTTGGATAGTGGGAGGCAGTTCT  361

Query  361  GTTTATAAGGAAGCCATGAATCACCCAGGCCATCTTAAACTATTTGTGACAAGGATCATG  420
            || |||||||||||||||||  | ||||||||||||| ||||||||||||||||||||||
Sbjct  362  GTATATAAGGAAGCCATGAACAAGCCAGGCCATCTTAGACTATTTGTGACAAGGATCATG  421

Query  421  CAAGACTTTGAAAGTGACACGTTTTTTCCAGAAATTGATTTGGAGAAATATAAACTTCTG  480
            ||||| |||||||||||   |||||| |||||||||||||| || |||||||||||||| 
Sbjct  422  CAAGAATTTGAAAGTGATGTGTTTTTCCCAGAAATTGATTTTGAAAAATATAAACTTCTT  481

Query  481  CCAGAATACCCAGGTGTTCTCTCTGATGTCCAGGAGGAGAAAGGCATTAAGTACAAATTT  540
            |||||||| ||||||||||  |  |||||||||||||| |||||||||||||||||||||
Sbjct  482  CCAGAATATCCAGGTGTTCCTTTGGATGTCCAGGAGGAAAAAGGCATTAAGTACAAATTT  541

Query  541  GAAGTATATGAGAAGAATGATTAA  564
            ||||||||||| |||||  |||||
Sbjct  542  GAAGTATATGAAAAGAACAATTAA  565</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-2">2</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-4">4</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-6">6</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-8">8</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-10">10</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-12">12</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-14">14</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-16">16</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-18">18</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-20">20</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-22">22</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-24">24</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-26">26</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-28">28</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-30">30</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-32">32</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-34">34</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-36">36</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-64f105b05e9af972063134-38">38</div><div class="crayon-num" data-line="crayon-64f105b05e9af972063134-39">39</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64f105b05e9af972063134-1"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">ATGGTTGGTTCGCTAAACTGCATCGTCGCTGTGTCCCAGAACATGGGCATCGGCAAGAAC</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">60</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-3"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">52</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">ATGGTTCGTCCGCTAAACTGCATCGTCGCTGTGTCCCAGAACATGGGCATCGGCAAGAAC</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">111</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-4">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-5"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">61</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">GGGGACCTGCCCTGGCCACCGCTCAGGAATGAATTCAGATATTTCCAGAGAATGACCACA</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">120</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-7"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">112</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GGGAACCTGCCCTGGCCACCACTCAG</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">137</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-8">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-9"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">121</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">ACCTCTTCAGTAGAAGGTAAACAGAATCTGGTGATTATGGGTAAGAAGACCTGGTTCTCC</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">180</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-11"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">138</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-i">GTAAACAGAATTTGGTGATTATGGGTAGGAAGACCTGGTTCTCC</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">181</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-12">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-13"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">181</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">ATTCCTGAGAAGAATCGACCTTTAAAGGGTAGAATTAATTTAGTTCTCAGCAGAGAACTC</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">240</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-15"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">182</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">ATTCCAGAGAAGAATCGACCTTTAAAGGACAGAATTAATATAGTTCTCAGTAGAGAACTC</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">241</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-16">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-17"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">241</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">AAGGAACCTCCACAAGGAGCTCATTTTCTTTCCAGAAGTCTAGATGATGCCTTAAAACTT</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">300</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-19"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">242</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">AAGGAACCTCCAAAGGGAGCTCATTTTCTTGCCAAAAGTCTGGATGATGCCTTAGAACTT</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">301</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-20">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-21"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">301</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">ACTGAACAACCAGAATTAGCAAATAAAGTAGACATGGTCTGGATAGTTGGTGGCAGTTCT</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">360</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-23"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">302</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">ATTGAAGATCCAGAATTAACAAATAAAGTAGACATGGTTTGGATAGTGGGAGGCAGTTCT</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">361</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-24">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-25"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">361</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">GTTTATAAGGAAGCCATGAATCACCCAGGCCATCTTAAACTATTTGTGACAAGGATCATG</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">420</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-27"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">362</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">GTATATAAGGAAGCCATGAACAAGCCAGGCCATCTTAGACTATTTGTGACAAGGATCATG</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">421</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-28">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-29"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">421</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">CAAGACTTTGAAAGTGACACGTTTTTTCCAGAAATTGATTTGGAGAAATATAAACTTCTG</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">480</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-31"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">422</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">CAAGAATTTGAAAGTGATGTGTTTTTCCCAGAAATTGATTTTGAAAAATATAAACTTCTT</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">481</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-32">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-33"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">481</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">CCAGAATACCCAGGTGTTCTCTCTGATGTCCAGGAGGAGAAAGGCATTAAGTACAAATTT</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">540</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-35"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">482</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">CCAGAATATCCAGGTGTTCCTTTGGATGTCCAGGAGGAAAAAGGCATTAAGTACAAATTT</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">541</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-36">&nbsp;</div><div class="crayon-line" id="crayon-64f105b05e9af972063134-37"><span class="crayon-i">Query</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">541</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">GAAGTATATGAGAAGAATGATTAA</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">564</span></div><div class="crayon-line crayon-striped-line" id="crayon-64f105b05e9af972063134-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-o">||</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-64f105b05e9af972063134-39"><span class="crayon-i">Sbjct</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">542</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">GAAGTATATGAAAAGAACAATTAA</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">565</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
<p></p>
<p>It is no wonder we couldn&#8217;t recover 100% of the <code>XM_012113510</code> haplotype, when compared to our pseudo-reference, 10% of it doesn&#8217;t fucking exist. Yet, it is interesting to see that the best recovered <code>XM_012113510</code>&#8216;s were identified by <code>BLAST</code> to be very good hits to the <code>XM_012113510</code> that actually exists in nature, despite my spurious 50bp insertion. Although <code>Gretel</code> is still biased by the structure of the pseudo-reference, (which is one of the reasons that insertions and deletions are still a pain), we are still able to make accurate recoveries around straightforward indel sites like this.</p>
<p>As lovely as it is to have gotten to the bottom of the <code>XM_012113510</code> recovery troubles, this doesn&#8217;t really help our manuscript. We want to avoid complicated discussions and workarounds that may confuse or bore the reader. We already had trouble with our reviewers misunderstanding the purpose of the convoluted Triviome method and its evaluation. I don&#8217;t want to have to explain why recovery rates for <code>XM_012113510</code> need special consideration because of this large indel.</p>
<p>I decided the best option was to find a new member of the band.</p>
<h3>DHFR: Reunion Tour</h3>
<p>As is the case whenever I am certain something won&#8217;t take the entire day, this was not as easy as I anticipated. Whilst it was trivial to <code>BLAST</code> my chosen pseudo-reference once more and find a suitable replacement (reading beyond &#8220;query cover&#8221; alone this time), trouble arose once more in the form of reads dropped via alignment.</p>
<p><a href="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-22-18-40-53.png"><img src="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-22-18-40-53-1024x576.png" alt="" width="100%" class="alignnone size-large wp-image-2035" srcset="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-22-18-40-53-1024x576.png 1024w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-22-18-40-53-300x169.png 300w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-22-18-40-53-768x432.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>Determined that these sequences should (and must) align, <a href="https://samnicholls.net/2016/12/24/bowtie2-metagenomes/">I dedicated the day to finally find some <code>bowtie2</code> parameters that would more permissively align sequences</a> to my pseudo-reference to ensure <code>Gretel</code> had the necessary evidence to recover even the more dissimilar sequences:</p>
<p><a href="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-00-41-15.png"><img src="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-00-41-15-1024x576.png" alt="" width="100%" class="alignnone size-large wp-image-2058" srcset="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-00-41-15-1024x576.png 1024w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-00-41-15-300x169.png 300w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-00-41-15-768x432.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p><strong>Success.</strong></p>
<h2>So, what&#8217;s next?</h2>
<p>Wonderful. So after your productive day of heatmap generation, what are you going to do with your <strike>life</strike> new found alignment powers?</p>
<h4> Select a new DHFR line-up</h4>
<p>The door has been blown wide open here. Previously our input test haplotypes had a lower bound of around 90% sequence similarity to avoid the loss of too many reads. However with my definition that I have termed <code>--super-sensitive-local</code>, we can attempt recoveries of genes that are even more dissimilar from the reference! I&#8217;ve actually already made the selection, electing to keep <code>BC</code> (99.8%), <code>XR</code> (97.3%) and <code>AK</code> (90.2%). I&#8217;ve remove <code>KJ</code> (93.2%) and the troublemaking <code>XM</code> (85.1%) to make way for the excitingly dissimilar <code>M</code> (83.5%) and (a different) <code>XM</code> (78.7%).</p>
<h4> Make a pretty picture</h4>
<p>After some <a href="https://samnicholls.net/2016/11/16/disorganised-disaster/"><code>chitin</code></a> and Sun Grid Engine wrangling, I present this:</p>
<p><a href="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-05-30-25.png"><img src="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-05-30-25-1024x576.png" alt="" width="100%" class="alignnone size-large wp-image-2070" srcset="https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-05-30-25-1024x576.png 1024w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-05-30-25-300x169.png 300w, https://samnicholls.net/wp-content/uploads/2016/12/Screenshot-from-2016-12-23-05-30-25-768x432.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<h4> Stare in disbelief</h4>
<p>Holy crap. <strong>It works</strong>.</p>
<hr />
<h2>Conclusion</h2>
<ul>
<li>Find what is inevitably wrong with these surprisingly excellent results</li>
<li>Get this fucking paper done</li>
<li>Merry Christmas</li>
</ul>
<hr />
<p><a name="tldr"></a></p>
<h1>tl;dr</h1>
<ul>
<li>In a panic I went back to check my <code>DHFR</code> analysis and then despite it being OK, changed everything anyway</li>
<li>One of the genes from our paper is quite hard to recover, because 10% of it is fucking missing</li>
<li>Indels continue to be a pain in my arse</li>
<li>Contrary to what I said last week, <strong>not everything is awful</strong></li>
<li>Coverage really is integral to <code>Gretel</code>&#8216;s ability to make good recoveries</li>
<li>I&#8217;ve <a href="https://samnicholls.net/2016/12/24/bowtie2-metagenomes/">constructed some parameters that allow us to permissively align metagenomic reads to our pseudo-reference</a> and shown it to massively improve <code>Gretel</code>&#8216;s accuracy</li>
<li><code>bowtie2</code> needs some love &lt;3</li>
<li>I probably care far too much about integrity of data and results and should just write my paper already</li>
<li>A lot of my problems boil down to not being able to read</li>
<li>I owe Hadley Wickham a drink to making it so easy to make my graphs look so pretty</li>
<li>Everyone agrees this should be my last Christmas as a PhD</li>
<li>Tom is mad because I keep telling him about bugs and pitfalls I have find in bioinformatics tools</li>
</ul>
</div>
                
                        <div class="tag-well"><span><span class="fa fa-tags"></span>&nbsp;&nbsp; </span></div>
                
                <nav class="further-reading">
	<div class="previous">
		<span>Previous Post</span>
		<a href="https://samnicholls.net/2016/12/24/bowtie2-metagenomes/">bowtie2: Relaxed Parameters for Generous Alignments to Metagenomes</a>
	</div>
	<div class="next">
		<span>Next Post</span>
		<a href="https://samnicholls.net/2017/01/30/laptop-laser-engrave/">Laser Etching my XPS 13 Laptop: Orphan Black style</a>
	</div>
</nav>            </article>
                                <div class="card">

<div id="disqus_thread"></div>
                </div>
    
</section>

        <!-- Sidebar -->
        <aside class="col-md-4 sidebar-container">
		            <div id="widget-area" class="widget-area" role="complementary">
                <div id="custom_html-3" class="widget_text card widget widget_custom_html"><div class="textwidget custom-html-widget"><img src="https://pbs.twimg.com/profile_images/1044255545610436609/wt33ZbtU_400x400.jpg" height=120 style="margin-top: 20px; margin-right:10px; float: left;" alt="Sam Nicholls" />
<div style="padding-top:15px; line-height: normal"><b style="font-size: 1.2em">Sam Nicholls</b><br><span style="font-size: 0.9em;">Haplotype Wrangler at University of Birmingham.<br>I tell computers to do things, then I write about how it all went wrong.</span></div></div></div><div id="search-2" class="card widget widget_search"><form style="margin-top:15px" action="https://samnicholls.net/" id="searchform" method="get" role="form">
    <div class="form-group">
        <input type="text" class="form-control" name="s" id="s" placeholder="e.g. Search...">
    </div>
</form>
</div><div id="twitter_timeline-5" class="card widget widget_twitter_timeline"><a class="twitter-timeline" data-height="400" data-theme="light" data-link-color="#f96e5b" data-border-color="#e8e8e8" data-lang="EN" data-partner="jetpack" data-chrome="noheader nofooter noborders" href="https://twitter.com/samstudio8">My Tweets</a></div><div id="categories-5" class="card widget widget_categories"><h2>Categories</h2>
			<ul>
					<li class="cat-item cat-item-2"><a href="https://samnicholls.net/category/bioinf/">Bioinformatics</a>
<ul class='children'>
	<li class="cat-item cat-item-8"><a href="https://samnicholls.net/category/bioinf/au-phd/">AU-PhD</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://samnicholls.net/category/bioinf/sanger-qc/" title="Sanger QC Project">Sanger-QC</a>
</li>
	<li class="cat-item cat-item-61"><a href="https://samnicholls.net/category/bioinf/tools/">Tools</a>
	<ul class='children'>
	<li class="cat-item cat-item-185"><a href="https://samnicholls.net/category/bioinf/tools/chitin/">chitin</a>
</li>
	</ul>
</li>
</ul>
</li>
	<li class="cat-item cat-item-80"><a href="https://samnicholls.net/category/devops/">Devops</a>
</li>
	<li class="cat-item cat-item-114"><a href="https://samnicholls.net/category/event/">Event</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://samnicholls.net/category/gadgets/">Gadgets</a>
</li>
	<li class="cat-item cat-item-176"><a href="https://samnicholls.net/category/hardware/">Hardware</a>
<ul class='children'>
	<li class="cat-item cat-item-223"><a href="https://samnicholls.net/category/hardware/beehive-monitor/">Beehive Monitor</a>
</li>
	<li class="cat-item cat-item-178"><a href="https://samnicholls.net/category/hardware/esp8266/">ESP8266</a>
</li>
	<li class="cat-item cat-item-236"><a href="https://samnicholls.net/category/hardware/lego-sequencer/">Lego Sequencer</a>
</li>
	<li class="cat-item cat-item-177"><a href="https://samnicholls.net/category/hardware/lightstick/">Lightstick</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-151"><a href="https://samnicholls.net/category/lab/">Lab</a>
<ul class='children'>
	<li class="cat-item cat-item-150"><a href="https://samnicholls.net/category/lab/protocol-guides/">Protocol Guides</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-5"><a href="https://samnicholls.net/category/meta/">Meta</a>
</li>
	<li class="cat-item cat-item-62"><a href="https://samnicholls.net/category/mysteries/">Mysteries</a>
</li>
	<li class="cat-item cat-item-22"><a href="https://samnicholls.net/category/personal/">Personal</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://samnicholls.net/category/photo/">Photography</a>
</li>
	<li class="cat-item cat-item-143"><a href="https://samnicholls.net/category/programming/">Programming</a>
<ul class='children'>
	<li class="cat-item cat-item-145"><a href="https://samnicholls.net/category/programming/documentation/">Documentation</a>
</li>
	<li class="cat-item cat-item-144"><a href="https://samnicholls.net/category/programming/python/">Python</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-48"><a href="https://samnicholls.net/category/status-report/">Status Report</a>
</li>
	<li class="cat-item cat-item-60"><a href="https://samnicholls.net/category/sysadm/">System Administration</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://samnicholls.net/category/uncategorised/">Uncategorised</a>
</li>
			</ul>

			</div>            </div>
		        </aside>
    </div>

</div> <!-- /container -->

<footer id="main-footer" class="bg-primary">
	<div id="footer-widgets" class="container">
		    </div>
</footer>



	<div style="display:none">
	</div>
<script type='text/javascript' src='https://samnicholls.net/wp-includes/js/comment-reply.min.js?ver=5.7.5' id='comment-reply-js'></script>
<script type='text/javascript' id='disqus_count-js-extra'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"samposium-blog"};
/* ]]> */
</script>
<script type='text/javascript' src='https://samnicholls.net/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.17' id='disqus_count-js'></script>
<script type='text/javascript' id='disqus_embed-js-extra'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.17"},"disqusIdentifier":"1916 https:\/\/samnicholls.net\/?p=1916","disqusShortname":"samposium-blog","disqusTitle":"Status Report: November 2016 (Part II): Revisiting the Synthetic Metahaplomes","disqusUrl":"https:\/\/samnicholls.net\/2016\/12\/24\/status-nov16-p2\/","postId":"1916"};
/* ]]> */
</script>
<script type='text/javascript' src='https://samnicholls.net/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.17' id='disqus_embed-js'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=202335' id='devicepx-js'></script>
<script type='text/javascript' src='https://samnicholls.net/wp-content/plugins/jetpack/_inc/twitter-timeline.js?ver=4.0.0' id='jetpack-twitter-timeline-js'></script>
<script type='text/javascript' src='https://samnicholls.net/wp-includes/js/wp-embed.min.js?ver=5.7.5' id='wp-embed-js'></script>
<script type='text/javascript' src='https://stats.wp.com/e-202335.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.9',blog:'101350222',post:'1916',tz:'1',srv:'samnicholls.net'} ]);
	_stq.push([ 'clickTrackerInit', '101350222', '1916' ]);
</script>

<script type="text/javascript">
(function() {
  if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
    var msViewportStyle = document.createElement("style");
    msViewportStyle.appendChild(
      document.createTextNode("@-ms-viewport{width:auto!important}")
    );
    document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
  }
})();

var collapsed = false;
jQuery( document ).ready(function($) {
    $('.navbar-toggle').click(function(){
        console.log(collapsed);
        if(collapsed) {
            $('.navbar-header > button').html('<i class="fa fa-bars"></i>');
        } else {
            $('.navbar-header > button').html('<i class="fa fa-times"></i>');
        }
        $('.navbar-collapse').toggle(200);
        collapsed = !collapsed;
    });
});
</script>
	
</body>

</html>
